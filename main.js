!function(){"use strict";class t{constructor(t,e){let{data:s,handleImageClick:n}=t;this._data=s,this._cardSelector=e,this._handleImageClick=n}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeButton()})),this._deleteButton.addEventListener("click",(()=>{this._handleDeletePost()})),this._cardImage.addEventListener("click",(()=>{this._handleImageClick(this._data)}))}_handleLikeButton(){this._likeButton.classList.toggle("post__like_active")}_handleDeletePost(){this._cardElement.remove(),this._cardElement=null}_getTemplate(){return document.querySelector(this._cardSelector).content.querySelector(".post").cloneNode(!0)}getView(){return this._cardElement=this._getTemplate(),this._likeButton=this._cardElement.querySelector(".post__like"),this._deleteButton=this._cardElement.querySelector(".post__delete"),this._cardImage=this._cardElement.querySelector(".post__image"),this._cardName=this._cardElement.querySelector(".post__title"),this._cardImage.src=this._data.link,this._cardImage.alt=this._data.name,this._cardName.textContent=this._data.name,this._setEventListeners(),this._cardElement}}class e{constructor(t,e){this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass,this._form=e}_showInputError(t,e){const s=this._form.querySelector(`.${t.id}-error`);t.classList.add(this._inputErrorClass),s.textContent=e,s.classList.add(this._errorClass)}_hideInputError(t){const e=this._form.querySelector(`.${t.id}-error`);t.classList.remove(this._inputErrorClass),e.classList.remove(this._errorClass),e.textContent=""}_toggleButtonState(){this._hasInvalidInput(this._inputList)?this.disableButton():(this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.disabled=!1)}disableButton(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.disabled=!0}_hasInvalidInput(){return this._inputList.some((t=>!t.validity.valid))}_checkInputValidity(t){t.validity.valid?this._hideInputError(t):this._showInputError(t,t.validationMessage)}resetValidation(){this.disableButton(),this._inputList.forEach((t=>{this._hideInputError(t)}))}_setEventListeners(){this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._buttonElement=this._form.querySelector(this._submitButtonSelector),this._inputList.forEach((t=>{t.addEventListener("input",(()=>{this._checkInputValidity(t),this._toggleButtonState()}))})),this.resetValidation()}enableValidation(){this._form.addEventListener("submit",(t=>{t.preventDefault()})),this._setEventListeners()}}const s=document.querySelector(".profile__add-button"),n=document.querySelector(".profile__edit-button"),o=document.querySelector("#modal__input_type_name"),r=document.querySelector("#modal__input_type_description");class i{constructor(t){let{popupSelector:e}=t;this._popupElement=document.querySelector(e),this._handleEscUp=this._handleEscUp.bind(this)}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keyup",this._handleEscUp)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keyup",this._handleEscUp)}_handleEscUp(t){t.preventDefault(),"Escape"===t.key&&this.close()}setEventListeners(){this._closeButton=this._popupElement.querySelector(".modal__close"),this._closeButton.addEventListener("click",(()=>{this.close()})),this._popupElement.addEventListener("click",(t=>{t.target===t.currentTarget&&this.close()}))}}class a extends i{constructor(t,e){super({popupSelector:t}),this._popupForm=this._popupElement.querySelector(".modal__form"),this._handleFormSubmit=e,this._formInputs=Array.from(this._popupForm.querySelectorAll(".modal__input"))}_getInputValues(){const t={};return this._formInputs.forEach((e=>{t[e.name]=e.value})),t}setEventListeners(){this._popupForm.addEventListener("submit",(t=>{t.preventDefault(),this._handleFormSubmit(this._getInputValues()),this._popupForm.reset()})),super.setEventListeners()}}const l=new class{constructor(t){let{name:e,job:s}=t;this._name=document.querySelector(e),this._job=document.querySelector(s)}getUserInfo(){return{name:this._name.textContent,job:this._job.textContent}}setUserInfo(t){let{name:e,job:s}=t;this._name.textContent=e,this._job.textContent=s}}({name:".profile__name",job:".profile__description"});n.addEventListener("click",(()=>{o.value=l.getUserInfo().name,r.value=l.getUserInfo().job,p.open(),c["modal__profile-form"].resetValidation()})),s.addEventListener("click",(()=>{m.open()}));const c={};var u;u={formSelector:".modal__form",inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__input-error_enabled"},Array.from(document.querySelectorAll(u.formSelector)).forEach((t=>{const s=new e(u,t),n=t.getAttribute("id");c[n]=s,s.enableValidation()}));const _=e=>new t({data:e,handleImageClick:t=>{d.open(t)}},"#post").getView(),d=new class extends i{constructor(t){super({popupSelector:t}),this._popupImage=this._popupElement.querySelector(".modal__image"),this._popupText=this._popupElement.querySelector(".modal__text")}open(t){let{name:e,link:s}=t;this._popupText.textContent=e,this._popupImage.src=s,this._popupImage.alt=e,super.open()}}("#expand-modal"),p=new a("#profile-modal",(t=>{let{name:e,job:s}=t;l.setUserInfo({name:e,job:s}),p.close()})),m=new a("#post-modal",(t=>{let{title:e,url:s}=t;const n=_({name:e,link:s});h.addNewItem(n),m.close(),c["modal__post-form"].disableButton()})),h=new class{constructor(t,e){let{items:s,renderer:n}=t;this._items=s,this._renderer=n,this._container=document.querySelector(e)}renderItems(){this._items.forEach((t=>{this._renderer(t)}))}addItem(t){this._container.append(t)}addNewItem(t){this._container.prepend(t)}}({items:[{name:"Yosemite Valley",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/yosemite.jpg"},{name:"Lake Louise",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lake-louise.jpg"},{name:"Bald Mountains",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/bald-mountains.jpg"},{name:"Latemar",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/latemar.jpg"},{name:"Vanoise National Park",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/vanoise.jpg"},{name:"Lago di Braies",link:"https://practicum-content.s3.us-west-1.amazonaws.com/software-engineer/around-project/lago.jpg"}],renderer:t=>{const e=_(t);h.addItem(e)}},".posts");h.renderItems(),d.setEventListeners(),p.setEventListeners(),m.setEventListeners()}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNORixLQUFNLHlHQUVSLENBQ0VFLEtBQU0saUJBQ05GLEtBQU0sNEdBRVIsQ0FDRUUsS0FBTSxVQUNORixLQUFNLHFHQUVSLENBQ0VFLEtBQU0sd0JBQ05GLEtBQU0scUdBRVIsQ0FDRUUsS0FBTSxpQkFDTkYsS0FBTSxtR0d1RU5rRyxTQUFXM0gsSUFDVCxNQUFNcUksRUFBY3RCLEVBQVcvRyxHQUMvQnVILEVBQVlVLFFBQVFJLEVBQVksR0gxRHZCLFVHaUVmZCxFQUFZUSxjQUNaZCxFQUFpQi9CLG9CQUNqQnFCLEVBQWlCckIsb0JBQ2pCdUIsRUFBY3ZCLG1CIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQ2FyZC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy91dGlscy9jb25zdGFudHMuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcclxuICBjb25zdHJ1Y3Rvcih7IGRhdGEsIGhhbmRsZUltYWdlQ2xpY2sgfSwgY2FyZFNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcclxuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcclxuICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sgPSBoYW5kbGVJbWFnZUNsaWNrO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gICAgICB0aGlzLl9oYW5kbGVMaWtlQnV0dG9uKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcclxuICAgICAgdGhpcy5faGFuZGxlRGVsZXRlUG9zdCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuX2hhbmRsZUltYWdlQ2xpY2sodGhpcy5fZGF0YSk7XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVMaWtlQnV0dG9uKCkge1xyXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwicG9zdF9fbGlrZV9hY3RpdmVcIik7XHJcbiAgfVxyXG5cclxuICBfaGFuZGxlRGVsZXRlUG9zdCgpIHtcclxuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBudWxsO1xyXG4gIH1cclxuXHJcbiAgX2dldFRlbXBsYXRlKCkge1xyXG4gICAgcmV0dXJuIGRvY3VtZW50XHJcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcclxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5wb3N0XCIpXHJcbiAgICAgIC5jbG9uZU5vZGUodHJ1ZSk7XHJcbiAgfVxyXG5cclxuICBnZXRWaWV3KCkge1xyXG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSB0aGlzLl9nZXRUZW1wbGF0ZSgpO1xyXG5cclxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvc3RfX2xpa2VcIik7XHJcbiAgICB0aGlzLl9kZWxldGVCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLnBvc3RfX2RlbGV0ZVwiKTtcclxuICAgIHRoaXMuX2NhcmRJbWFnZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9zdF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9jYXJkTmFtZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucG9zdF9fdGl0bGVcIik7XHJcblxyXG4gICAgdGhpcy5fY2FyZEltYWdlLnNyYyA9IHRoaXMuX2RhdGEubGluaztcclxuICAgIHRoaXMuX2NhcmRJbWFnZS5hbHQgPSB0aGlzLl9kYXRhLm5hbWU7XHJcbiAgICB0aGlzLl9jYXJkTmFtZS50ZXh0Q29udGVudCA9IHRoaXMuX2RhdGEubmFtZTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG5cclxuICAgIHJldHVybiB0aGlzLl9jYXJkRWxlbWVudDtcclxuICB9XHJcbn1cclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XHJcbiAgY29uc3RydWN0b3Ioc2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XHJcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gc2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcclxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gc2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XHJcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gc2V0dGluZ3MuaW5hY3RpdmVCdXR0b25DbGFzcztcclxuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcclxuICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBzZXR0aW5ncy5lcnJvckNsYXNzO1xyXG5cclxuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcclxuICB9XHJcblxyXG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xyXG4gICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKGAuJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XHJcbiAgICBpbnB1dEVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xyXG4gICAgZXJyb3JFbGVtZW50LnRleHRDb250ZW50ID0gZXJyb3JNZXNzYWdlO1xyXG4gICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XHJcbiAgfVxyXG5cclxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XHJcbiAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoYC4ke2lucHV0RWxlbWVudC5pZH0tZXJyb3JgKTtcclxuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XHJcbiAgICBlcnJvckVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcclxuICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IFwiXCI7XHJcbiAgfVxyXG5cclxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XHJcbiAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KHRoaXMuX2lucHV0TGlzdCkpIHtcclxuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICAgIHRoaXMuX2J1dHRvbkVsZW1lbnQuZGlzYWJsZWQgPSBmYWxzZTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGRpc2FibGVCdXR0b24oKSB7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XHJcbiAgICB0aGlzLl9idXR0b25FbGVtZW50LmRpc2FibGVkID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIF9oYXNJbnZhbGlkSW5wdXQoKSB7XHJcbiAgICByZXR1cm4gdGhpcy5faW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICByZXR1cm4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZDtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcclxuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XHJcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICByZXNldFZhbGlkYXRpb24oKSB7XHJcbiAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcclxuICAgIHRoaXMuX2lucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcclxuICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xyXG4gICAgdGhpcy5faW5wdXRMaXN0ID0gQXJyYXkuZnJvbShcclxuICAgICAgdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpXHJcbiAgICApO1xyXG4gICAgdGhpcy5fYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3Rvcih0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3Rvcik7XHJcblxyXG4gICAgdGhpcy5faW5wdXRMaXN0LmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xyXG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcclxuICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcclxuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIHRoaXMucmVzZXRWYWxpZGF0aW9uKCk7XHJcbiAgfVxyXG5cclxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xyXG4gICAgdGhpcy5fZm9ybS5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xyXG4gIH1cclxufVxyXG4iLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xyXG4gIHtcclxuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QveW9zZW1pdGUuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFrZS1sb3Vpc2UuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkJhbGQgTW91bnRhaW5zXCIsXHJcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXHJcbiAgfSxcclxuICB7XHJcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcclxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC92YW5vaXNlLmpwZ1wiLFxyXG4gIH0sXHJcbiAge1xyXG4gICAgbmFtZTogXCJMYWdvIGRpIEJyYWllc1wiLFxyXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXHJcbiAgfSxcclxuXTtcclxuXHJcbi8vVmFsaWRhdGlvblxyXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvblNldHRpbmdzID0ge1xyXG4gIGZvcm1TZWxlY3RvcjogXCIubW9kYWxfX2Zvcm1cIixcclxuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcclxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxyXG4gIGluYWN0aXZlQnV0dG9uQ2xhc3M6IFwibW9kYWxfX2J1dHRvbl9kaXNhYmxlZFwiLFxyXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxyXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2lucHV0LWVycm9yX2VuYWJsZWRcIixcclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBzZWxlY3RvcnMgPSB7XHJcbiAgcG9zdFNlY3Rpb246IFwiLnBvc3RzXCIsXHJcbiAgcG9zdFRlbXBsYXRlOiBcIiNwb3N0XCIsXHJcbiAgcHJldmlld1BvcHVwOiBcIiNleHBhbmQtbW9kYWxcIixcclxuICBlZGl0UHJvZmlsZU1vZGFsOiBcIiNwcm9maWxlLW1vZGFsXCIsXHJcbiAgZWRpdFByb2ZpbGVGb3JtOiBcIm1vZGFsX19wcm9maWxlLWZvcm1cIixcclxuICBhZGRQb3N0TW9kYWw6IFwiI3Bvc3QtbW9kYWxcIixcclxuICBhZGRQb3N0Rm9ybTogXCJtb2RhbF9fcG9zdC1mb3JtXCIsXHJcbiAgcHJvZmlsZU5hbWU6IFwiLnByb2ZpbGVfX25hbWVcIixcclxuICBwcm9maWxlSm9iOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxyXG59O1xyXG5cclxuZXhwb3J0IGNvbnN0IGFkZFBvc3RCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XHJcblxyXG5leHBvcnQgY29uc3QgZWRpdFByb2ZpbGVCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiLnByb2ZpbGVfX2VkaXQtYnV0dG9uXCJcclxuKTtcclxuZXhwb3J0IGNvbnN0IHByb2ZpbGVOYW1lSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxyXG4gIFwiI21vZGFsX19pbnB1dF90eXBlX25hbWVcIlxyXG4pO1xyXG5leHBvcnQgY29uc3QgcHJvZmlsZUpvYklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICBcIiNtb2RhbF9faW5wdXRfdHlwZV9kZXNjcmlwdGlvblwiXHJcbik7XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFNlbGVjdG9yKTtcclxuICAgIHRoaXMuX2hhbmRsZUVzY1VwID0gdGhpcy5faGFuZGxlRXNjVXAuYmluZCh0aGlzKTtcclxuICB9XHJcblxyXG4gIG9wZW4oKSB7XHJcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcclxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCB0aGlzLl9oYW5kbGVFc2NVcCk7XHJcbiAgfVxyXG5cclxuICBjbG9zZSgpIHtcclxuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKFwibW9kYWxfb3BlbmVkXCIpO1xyXG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIHRoaXMuX2hhbmRsZUVzY1VwKTtcclxuICB9XHJcblxyXG4gIF9oYW5kbGVFc2NVcChldnQpIHtcclxuICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcclxuICAgICAgdGhpcy5jbG9zZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9jbG9zZUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jbG9zZVwiKTtcclxuICAgIHRoaXMuX2Nsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgIH0pO1xyXG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGlmIChldnQudGFyZ2V0ID09PSBldnQuY3VycmVudFRhcmdldCkge1xyXG4gICAgICAgIHRoaXMuY2xvc2UoKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcclxuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XHJcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcclxuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xyXG4gICAgdGhpcy5fZm9ybUlucHV0cyA9IEFycmF5LmZyb20oXHJcbiAgICAgIHRoaXMuX3BvcHVwRm9ybS5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcclxuICAgIGNvbnN0IGRhdGEgPSB7fTtcclxuICAgIHRoaXMuX2Zvcm1JbnB1dHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcclxuICAgICAgZGF0YVtpbnB1dC5uYW1lXSA9IGlucHV0LnZhbHVlO1xyXG4gICAgfSk7XHJcbiAgICByZXR1cm4gZGF0YTtcclxuICAgIC8vY29sbGVjdHMgZGF0YSBmcm9tIGFsbCB0aGUgaW5wdXQgZmllbGRzIGFuZCByZXR1cm5zIGl0IGFzIGFuIG9iamVjdCwgdGhlbiBwYXNzIHRvIHN1Ym1pc3Npb24gaGFuZGxlclxyXG4gIH1cclxuXHJcbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XHJcbiAgICB0aGlzLl9wb3B1cEZvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xyXG4gICAgICB0aGlzLl9wb3B1cEZvcm0ucmVzZXQoKTtcclxuICAgIH0pO1xyXG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuICAgIC8vYWRkIHN1Ym1pdCBldmVudCBsaXN0ZW5lciB0byBmb3JtLCB0aGVuIHN1cGVyKCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCBcIi4vaW5kZXguY3NzXCI7XHJcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcclxuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xyXG5pbXBvcnQge1xyXG4gIGluaXRpYWxDYXJkcyxcclxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXHJcbiAgc2VsZWN0b3JzLFxyXG4gIGFkZFBvc3RCdXR0b24sXHJcbiAgZWRpdFByb2ZpbGVCdXR0b24sXHJcbiAgcHJvZmlsZU5hbWVJbnB1dCxcclxuICBwcm9maWxlSm9iSW5wdXQsXHJcbn0gZnJvbSBcIi4uL3V0aWxzL2NvbnN0YW50cy5qc1wiO1xyXG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XHJcbmltcG9ydCBQb3B1cFdpdGhJbWFnZSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qc1wiO1xyXG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcclxuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xyXG5cclxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oe1xyXG4gIG5hbWU6IHNlbGVjdG9ycy5wcm9maWxlTmFtZSxcclxuICBqb2I6IHNlbGVjdG9ycy5wcm9maWxlSm9iLFxyXG59KTtcclxuXHJcbmVkaXRQcm9maWxlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XHJcbiAgcHJvZmlsZU5hbWVJbnB1dC52YWx1ZSA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCkubmFtZTtcclxuICBwcm9maWxlSm9iSW5wdXQudmFsdWUgPSB1c2VySW5mby5nZXRVc2VySW5mbygpLmpvYjtcclxuICBwcm9maWxlRm9ybVBvcHVwLm9wZW4oKTtcclxuXHJcbiAgZm9ybVZhbGlkYXRvcnNbc2VsZWN0b3JzLmVkaXRQcm9maWxlRm9ybV0ucmVzZXRWYWxpZGF0aW9uKCk7XHJcbn0pO1xyXG5cclxuYWRkUG9zdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xyXG4gIHBvc3RGb3JtUG9wdXAub3BlbigpO1xyXG59KTtcclxuXHJcbmNvbnN0IGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0ID0gKHsgbmFtZSwgam9iIH0pID0+IHtcclxuICB1c2VySW5mby5zZXRVc2VySW5mbyh7IG5hbWUsIGpvYiB9KTtcclxuICBwcm9maWxlRm9ybVBvcHVwLmNsb3NlKCk7XHJcbn07XHJcblxyXG5jb25zdCBoYW5kbGVQb3N0Rm9ybVN1Ym1pdCA9ICh7IHRpdGxlLCB1cmwgfSkgPT4ge1xyXG4gIGNvbnN0IG5ld1Bvc3QgPSB7XHJcbiAgICBuYW1lOiB0aXRsZSxcclxuICAgIGxpbms6IHVybCxcclxuICB9O1xyXG4gIGNvbnN0IG5ld0NhcmQgPSBjcmVhdGVDYXJkKG5ld1Bvc3QpO1xyXG4gIGNhcmRTZWN0aW9uLmFkZE5ld0l0ZW0obmV3Q2FyZCk7XHJcbiAgcG9zdEZvcm1Qb3B1cC5jbG9zZSgpO1xyXG5cclxuICBmb3JtVmFsaWRhdG9yc1tzZWxlY3RvcnMuYWRkUG9zdEZvcm1dLmRpc2FibGVCdXR0b24oKTtcclxufTtcclxuXHJcbi8vRm9ybSB2YWxpZGF0aW9uXHJcbmNvbnN0IGZvcm1WYWxpZGF0b3JzID0ge307XHJcblxyXG5jb25zdCBlbmFibGVWYWxpZGF0aW9uID0gKGNvbmZpZykgPT4ge1xyXG4gIGNvbnN0IGZvcm1MaXN0ID0gQXJyYXkuZnJvbShkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKGNvbmZpZy5mb3JtU2VsZWN0b3IpKTtcclxuICBmb3JtTGlzdC5mb3JFYWNoKChmb3JtRWxlbWVudCkgPT4ge1xyXG4gICAgY29uc3QgdmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoY29uZmlnLCBmb3JtRWxlbWVudCk7XHJcbiAgICBjb25zdCBmb3JtSWQgPSBmb3JtRWxlbWVudC5nZXRBdHRyaWJ1dGUoXCJpZFwiKTtcclxuXHJcbiAgICBmb3JtVmFsaWRhdG9yc1tmb3JtSWRdID0gdmFsaWRhdG9yO1xyXG4gICAgdmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcclxuICB9KTtcclxufTtcclxuXHJcbmVuYWJsZVZhbGlkYXRpb24odmFsaWRhdGlvblNldHRpbmdzKTtcclxuXHJcbi8vY3JlYXRlIGluc3RhbmNlc1xyXG5jb25zdCBjcmVhdGVDYXJkID0gKGRhdGEpID0+IHtcclxuICBjb25zdCBjYXJkRWxlbWVudCA9IG5ldyBDYXJkKFxyXG4gICAge1xyXG4gICAgICBkYXRhLFxyXG4gICAgICBoYW5kbGVJbWFnZUNsaWNrOiAoaW1nRGF0YSkgPT4ge1xyXG4gICAgICAgIGNhcmRQcmV2aWV3UG9wdXAub3BlbihpbWdEYXRhKTtcclxuICAgICAgfSxcclxuICAgIH0sXHJcbiAgICBzZWxlY3RvcnMucG9zdFRlbXBsYXRlXHJcbiAgKTtcclxuICByZXR1cm4gY2FyZEVsZW1lbnQuZ2V0VmlldygpO1xyXG59O1xyXG5cclxuY29uc3QgY2FyZFByZXZpZXdQb3B1cCA9IG5ldyBQb3B1cFdpdGhJbWFnZShzZWxlY3RvcnMucHJldmlld1BvcHVwKTtcclxuY29uc3QgcHJvZmlsZUZvcm1Qb3B1cCA9IG5ldyBQb3B1cFdpdGhGb3JtKFxyXG4gIHNlbGVjdG9ycy5lZGl0UHJvZmlsZU1vZGFsLFxyXG4gIGhhbmRsZVByb2ZpbGVGb3JtU3VibWl0XHJcbik7XHJcbmNvbnN0IHBvc3RGb3JtUG9wdXAgPSBuZXcgUG9wdXBXaXRoRm9ybShcclxuICBzZWxlY3RvcnMuYWRkUG9zdE1vZGFsLFxyXG4gIGhhbmRsZVBvc3RGb3JtU3VibWl0XHJcbik7XHJcblxyXG5jb25zdCBjYXJkU2VjdGlvbiA9IG5ldyBTZWN0aW9uKFxyXG4gIHtcclxuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXHJcbiAgICByZW5kZXJlcjogKGRhdGEpID0+IHtcclxuICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGRhdGEpO1xyXG4gICAgICBjYXJkU2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcclxuICAgIH0sXHJcbiAgfSxcclxuICBzZWxlY3RvcnMucG9zdFNlY3Rpb25cclxuKTtcclxuXHJcbi8vaW5pdGlhbGl6ZSBpbnN0YW5jZXNcclxuY2FyZFNlY3Rpb24ucmVuZGVySXRlbXMoKTtcclxuY2FyZFByZXZpZXdQb3B1cC5zZXRFdmVudExpc3RlbmVycygpO1xyXG5wcm9maWxlRm9ybVBvcHVwLnNldEV2ZW50TGlzdGVuZXJzKCk7XHJcbnBvc3RGb3JtUG9wdXAuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcclxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgVXNlckluZm8ge1xyXG4gIGNvbnN0cnVjdG9yKHsgbmFtZSwgam9iIH0pIHtcclxuICAgIHRoaXMuX25hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWUpO1xyXG4gICAgdGhpcy5fam9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihqb2IpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VXNlckluZm8oKSB7XHJcbiAgICByZXR1cm4geyBuYW1lOiB0aGlzLl9uYW1lLnRleHRDb250ZW50LCBqb2I6IHRoaXMuX2pvYi50ZXh0Q29udGVudCB9O1xyXG4gICAgLy9yZXR1cm5zIGFuIG9iamVjdCBjb250YWluaW5nIGluZm8gYWJvdXQgdGhlIHVzZXJcclxuICB9XHJcblxyXG4gIHNldFVzZXJJbmZvKHsgbmFtZSwgam9iIH0pIHtcclxuICAgIHRoaXMuX25hbWUudGV4dENvbnRlbnQgPSBuYW1lO1xyXG4gICAgdGhpcy5fam9iLnRleHRDb250ZW50ID0gam9iO1xyXG4gICAgLy90YWtlcyBuZXcgdXNlciBkYXRhIGFuZCBhZGRzIGl0IHRvIHRoZSBwYWdlLCB1c2UgYWZ0ZXIgc3VjY2Vzc2Z1bCBzdWJtaXNzaW9uIG9mIHByb2ZpbGUgZm9ybVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgUG9wdXAgZnJvbSBcIi4vUG9wdXAuanNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xyXG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcclxuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcclxuICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9faW1hZ2VcIik7XHJcbiAgICB0aGlzLl9wb3B1cFRleHQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fdGV4dFwiKTtcclxuICB9XHJcblxyXG4gIG9wZW4oeyBuYW1lLCBsaW5rIH0pIHtcclxuICAgIHRoaXMuX3BvcHVwVGV4dC50ZXh0Q29udGVudCA9IG5hbWU7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGxpbms7XHJcbiAgICB0aGlzLl9wb3B1cEltYWdlLmFsdCA9IG5hbWU7XHJcbiAgICBzdXBlci5vcGVuKCk7XHJcbiAgfVxyXG59XHJcbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xyXG4gIGNvbnN0cnVjdG9yKHsgaXRlbXMsIHJlbmRlcmVyIH0sIGNvbnRhaW5lclNlbGVjdG9yKSB7XHJcbiAgICB0aGlzLl9pdGVtcyA9IGl0ZW1zO1xyXG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcclxuICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVySXRlbXMoKSB7XHJcbiAgICB0aGlzLl9pdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBhZGRJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5hcHBlbmQoZWxlbWVudCk7XHJcbiAgfVxyXG5cclxuICBhZGROZXdJdGVtKGVsZW1lbnQpIHtcclxuICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiQ2FyZCIsImNvbnN0cnVjdG9yIiwiX3JlZiIsImNhcmRTZWxlY3RvciIsImRhdGEiLCJoYW5kbGVJbWFnZUNsaWNrIiwidGhpcyIsIl9kYXRhIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUxpa2VCdXR0b24iLCJfZGVsZXRlQnV0dG9uIiwiX2hhbmRsZURlbGV0ZVBvc3QiLCJfY2FyZEltYWdlIiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiX2NhcmRFbGVtZW50IiwicmVtb3ZlIiwiX2dldFRlbXBsYXRlIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwiY29udGVudCIsImNsb25lTm9kZSIsImdldFZpZXciLCJfY2FyZE5hbWUiLCJzcmMiLCJsaW5rIiwiYWx0IiwibmFtZSIsInRleHRDb250ZW50IiwiRm9ybVZhbGlkYXRvciIsInNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfZm9ybSIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwiYWRkIiwiX2hpZGVJbnB1dEVycm9yIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiX2hhc0ludmFsaWRJbnB1dCIsIl9pbnB1dExpc3QiLCJkaXNhYmxlQnV0dG9uIiwiX2J1dHRvbkVsZW1lbnQiLCJkaXNhYmxlZCIsInNvbWUiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkYXRpb25NZXNzYWdlIiwicmVzZXRWYWxpZGF0aW9uIiwiZm9yRWFjaCIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJlbmFibGVWYWxpZGF0aW9uIiwiZXZ0IiwicHJldmVudERlZmF1bHQiLCJhZGRQb3N0QnV0dG9uIiwiZWRpdFByb2ZpbGVCdXR0b24iLCJwcm9maWxlTmFtZUlucHV0IiwicHJvZmlsZUpvYklucHV0IiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwRWxlbWVudCIsIl9oYW5kbGVFc2NVcCIsImJpbmQiLCJvcGVuIiwiY2xvc2UiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwia2V5Iiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJfY2xvc2VCdXR0b24iLCJ0YXJnZXQiLCJjdXJyZW50VGFyZ2V0IiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9wb3B1cEZvcm0iLCJfaGFuZGxlRm9ybVN1Ym1pdCIsIl9mb3JtSW5wdXRzIiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXQiLCJ2YWx1ZSIsInJlc2V0IiwidXNlckluZm8iLCJqb2IiLCJfbmFtZSIsIl9qb2IiLCJnZXRVc2VySW5mbyIsInNldFVzZXJJbmZvIiwiX3JlZjIiLCJwcm9maWxlRm9ybVBvcHVwIiwiZm9ybVZhbGlkYXRvcnMiLCJwb3N0Rm9ybVBvcHVwIiwiY29uZmlnIiwiZm9ybVNlbGVjdG9yIiwidmFsaWRhdG9yIiwiZm9ybUlkIiwiZ2V0QXR0cmlidXRlIiwiY3JlYXRlQ2FyZCIsImltZ0RhdGEiLCJjYXJkUHJldmlld1BvcHVwIiwiX3BvcHVwSW1hZ2UiLCJfcG9wdXBUZXh0IiwidGl0bGUiLCJ1cmwiLCJuZXdDYXJkIiwiY2FyZFNlY3Rpb24iLCJhZGROZXdJdGVtIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX2l0ZW1zIiwiX3JlbmRlcmVyIiwiX2NvbnRhaW5lciIsInJlbmRlckl0ZW1zIiwiaXRlbSIsImFkZEl0ZW0iLCJlbGVtZW50IiwiYXBwZW5kIiwicHJlcGVuZCIsImNhcmRFbGVtZW50Il0sInNvdXJjZVJvb3QiOiIifQ==